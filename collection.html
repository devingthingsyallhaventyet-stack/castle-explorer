<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collection ‚Äî castlecore</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--stone:#d4c5a9;--cream:#f0ebe0;--candlelight:#c9a84c;--burgundy:#8b2335;--forest:#2d5a3d;--ivy:#3d5a3e;--shadow:#2a2522;--twilight:#4a5568;--hearth:#6b4c3b;--border:#e8e8e8;--radius:12px;--pill:20px;--warm-white:#faf8f4}
html{scroll-behavior:smooth}
body{font-family:'Inter',sans-serif;color:var(--shadow);line-height:1.6;-webkit-font-smoothing:antialiased;background:var(--warm-white)}
h1,h2,h3,h4{font-family:'Playfair Display',serif;font-weight:400}
a{text-decoration:none;color:inherit}
img{max-width:100%;display:block}

/* NAV */
.nav{position:fixed;top:0;left:0;right:0;z-index:1000;background:#fff;border-bottom:1px solid var(--border);height:64px;display:flex;align-items:center;padding:0 24px}
.nav-inner{max-width:1280px;margin:0 auto;width:100%;display:flex;align-items:center;justify-content:space-between}
.nav-logo{font-family:'Playfair Display',serif;font-size:1.3rem;display:flex;align-items:center;gap:8px}
.nav-links{display:flex;gap:24px;align-items:center}
.nav-links a{font-size:.9rem;font-weight:500;color:var(--twilight);transition:color .2s}
.nav-links a:hover{color:var(--ivy)}
.nav-links .btn-explore{background:var(--burgundy);color:#fff;padding:8px 18px;border-radius:var(--pill);font-weight:600}
.nav-links .btn-explore:hover{background:#6e1a2a}
.hamburger{display:none;background:none;border:none;font-size:1.5rem;cursor:pointer}
.mobile-menu{display:none;position:fixed;top:64px;left:0;right:0;background:#fff;border-bottom:1px solid var(--border);padding:16px 24px;flex-direction:column;gap:16px;z-index:999}
.mobile-menu.open{display:flex}
.mobile-menu a{font-size:1rem;font-weight:500;color:var(--twilight);padding:8px 0}
@media(max-width:768px){
.nav-links{display:none}
.hamburger{display:block}
}

/* HERO BANNER */
.collection-hero{margin-top:64px;padding:48px 24px 40px;text-align:center}
.collection-hero h1{font-size:clamp(1.8rem,4vw,2.8rem);margin-bottom:12px;color:#fff}
.collection-hero .hero-desc{color:rgba(255,255,255,.88);font-size:1.05rem;max-width:680px;margin:0 auto 16px;line-height:1.6;font-family:'Playfair Display',serif;font-style:italic}
.collection-hero .hero-count{color:rgba(255,255,255,.65);font-size:.9rem;font-weight:600}

/* HERO COLOR THEMES */
.hero-top-rated{background:linear-gradient(135deg,#8b6914,#c9a84c)}
.hero-hidden-gems{background:linear-gradient(135deg,#2d5a3d,#4a7c59)}
.hero-haunted{background:linear-gradient(135deg,#5a1a2a,#8b2335)}
.hero-filming-locations{background:linear-gradient(135deg,#2c3e5a,#4a6fa5)}
.hero-free{background:linear-gradient(135deg,#3d7a3e,#5a9a5c)}
.hero-well-preserved{background:linear-gradient(135deg,#6b5d4a,#8b7d6a)}
.hero-romantic-ruins{background:linear-gradient(135deg,#5e3a6e,#8a5a9e)}
.hero-photogenic{background:linear-gradient(135deg,#8e4a2a,#c06a3a)}
.hero-kid-friendly{background:linear-gradient(135deg,#2d5a3d,#c9a84c)}

/* MAIN LAYOUT */
.main-content{max-width:1280px;margin:0 auto;padding:24px;display:flex;gap:24px}

/* FILTER SIDEBAR */
.filter-sidebar{width:240px;flex-shrink:0}
.filter-sidebar h3{font-size:1rem;margin-bottom:16px;color:var(--shadow)}
.filter-section{margin-bottom:24px}
.filter-section h4{font-size:.85rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--twilight);margin-bottom:10px}
.filter-search{width:100%;padding:10px 14px;border:1px solid var(--border);border-radius:var(--radius);font-size:.9rem;font-family:'Inter',sans-serif;outline:none;background:#fff;transition:border-color .2s}
.filter-search:focus{border-color:var(--burgundy)}

/* CUSTOM CHECKBOXES */
.cb-label{display:flex;align-items:center;gap:8px;padding:6px 0;cursor:pointer;font-size:.9rem;color:var(--shadow)}
.cb-label input{display:none}
.cb-box{width:18px;height:18px;border:2px solid var(--border);border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}
.cb-label input:checked + .cb-box{background:var(--burgundy);border-color:var(--burgundy)}
.cb-label input:checked + .cb-box::after{content:'‚úì';color:#fff;font-size:.7rem;font-weight:700}
.cb-count{margin-left:auto;font-size:.75rem;color:var(--twilight)}

/* MOBILE FILTER TOGGLE */
.filter-toggle{display:none;width:100%;padding:12px 16px;background:#fff;border:1px solid var(--border);border-radius:var(--radius);font-size:.9rem;font-weight:600;cursor:pointer;text-align:left;margin-bottom:16px;font-family:'Inter',sans-serif}
.filter-toggle::after{content:'‚ñº';float:right;font-size:.7rem;transition:transform .2s}
.filter-toggle.open::after{transform:rotate(180deg)}

@media(max-width:768px){
.main-content{flex-direction:column}
.filter-sidebar{width:100%}
.filter-toggle{display:block}
.filter-body{display:none}
.filter-body.open{display:block}
}

/* RESULTS */
.results-area{flex:1;min-width:0}
.results-count{font-size:.9rem;color:var(--twilight);margin-bottom:16px;font-weight:500}

/* RESULTS GRID */
.results-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
@media(max-width:1024px){.results-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:600px){.results-grid{grid-template-columns:1fr}}

/* RESULT CARD */
.result-card{border-radius:16px;overflow:hidden;background:#fff;border:1px solid var(--border);transition:transform .25s,box-shadow .25s;box-shadow:0 2px 12px rgba(120,90,50,.06);display:flex;flex-direction:column}
.result-card:hover{transform:translateY(-3px);box-shadow:0 8px 28px rgba(120,90,50,.12)}
.result-card .card-img{height:180px;overflow:hidden;background:linear-gradient(135deg,var(--stone),var(--cream))}
.result-card .card-img img{width:100%;height:100%;object-fit:cover;transition:transform .3s}
.result-card:hover .card-img img{transform:scale(1.05)}
.result-card .card-body{padding:16px;flex:1;display:flex;flex-direction:column}
.result-card .card-body h3{font-size:1.05rem;margin-bottom:4px;line-height:1.3}
.result-card .card-loc{color:var(--twilight);font-size:.82rem;margin-bottom:8px}
.result-card .card-meta{display:flex;align-items:center;gap:8px;margin-top:auto}
.result-card .type-pill{display:inline-block;background:var(--cream);color:var(--ivy);font-size:.72rem;font-weight:600;padding:3px 10px;border-radius:var(--pill);text-transform:capitalize}
.result-card .card-rating{color:var(--candlelight);font-size:.82rem;font-weight:600}

/* ALL COLLECTIONS GRID (no ?id) */
.all-collections{max-width:1280px;margin:0 auto;padding:24px}
.all-collections h2{font-size:clamp(1.6rem,3vw,2.2rem);margin-bottom:8px}
.all-collections .tagline{color:var(--twilight);font-size:.95rem;margin-bottom:28px;font-family:'Playfair Display',serif;font-style:italic}
.all-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
@media(max-width:768px){.all-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:480px){.all-grid{grid-template-columns:1fr}}
.all-card{border-radius:16px;overflow:hidden;position:relative;height:220px;cursor:pointer;transition:transform .25s,box-shadow .25s}
.all-card:hover{transform:translateY(-3px);box-shadow:0 8px 28px rgba(0,0,0,.12)}
.all-card .all-card-bg{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:4rem}
.all-card .all-card-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,.6),rgba(0,0,0,.15));display:flex;flex-direction:column;justify-content:flex-end;padding:20px;color:#fff}
.all-card .all-card-overlay h3{font-size:1.2rem;margin-bottom:4px}
.all-card .all-card-overlay p{font-size:.82rem;opacity:.8}

/* FOOTER */
footer{background:var(--shadow);color:#fff;padding:64px 24px 32px}
.footer-inner{max-width:1280px;margin:0 auto}
.footer-top{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:32px;margin-bottom:48px}
.footer-brand .footer-logo{font-family:'Playfair Display',serif;font-size:1.3rem;margin-bottom:8px}
.footer-brand p{color:rgba(255,255,255,.6);font-size:.85rem;max-width:280px}
.footer-col h4{font-size:.85rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;margin-bottom:12px;color:rgba(255,255,255,.5)}
.footer-col a{display:block;color:rgba(255,255,255,.7);font-size:.9rem;margin-bottom:8px;transition:color .2s}
.footer-col a:hover{color:#fff}
.footer-bottom{border-top:1px solid rgba(255,255,255,.1);padding-top:24px;display:flex;justify-content:space-between;font-size:.8rem;color:rgba(255,255,255,.4);flex-wrap:wrap;gap:8px}
@media(max-width:768px){.footer-top{grid-template-columns:1fr 1fr;gap:24px}}
@media(max-width:480px){.footer-top{grid-template-columns:1fr}}
</style>
</head>
<body>

<!-- NAV -->
<nav class="nav">
<div class="nav-inner">
<a href="/" class="nav-logo">castlecore</a>
<div class="nav-links">
<a href="explore.html" class="btn-explore">Explore Map</a>
<a href="collection.html">Collections</a>
<a href="explore.html">Regions</a>
<a href="explore.html">Trails</a>
<a href="explore.html">Near Me</a>
</div>
<button class="hamburger" onclick="document.querySelector('.mobile-menu').classList.toggle('open')" aria-label="Menu">‚ò∞</button>
</div>
</nav>
<div class="mobile-menu">
<a href="explore.html">üó∫Ô∏è Explore Map</a>
<a href="collection.html">Collections</a>
<a href="explore.html">Regions</a>
<a href="explore.html">Trails</a>
<a href="explore.html">Near Me</a>
</div>

<!-- DYNAMIC CONTENT -->
<div id="app"></div>

<!-- FOOTER -->
<footer>
<div class="footer-inner">
<div class="footer-top">
<div class="footer-brand">
<div class="footer-logo">castlecore</div>
<p>The most complete heritage guide for the UK &amp; Ireland</p>
</div>
<div class="footer-col"><h4>Explore</h4><a href="explore.html">Map</a><a href="collection.html">Collections</a><a href="explore.html">Regions</a><a href="explore.html">Trails</a></div>
<div class="footer-col"><h4>Info</h4><a href="#">About</a><a href="#">Contact</a></div>
<div class="footer-col"><h4>Legal</h4><a href="#">Privacy</a><a href="#">Terms</a></div>
</div>
<div class="footer-bottom">
<span>Built with ‚ù§Ô∏è for history lovers</span>
<span>¬© 2026 castlecore</span>
</div>
</div>
</footer>

<script src="data.js"></script>
<script>
(function(){

const COLLECTIONS = {
  'top-rated': { emoji: 'üèÜ', name: 'Top Rated', desc: 'The highest-rated castles, abbeys and ruins across Britain and Ireland. These are the sites that visitors consistently rave about ‚Äî expect breathtaking architecture, rich history, and unforgettable experiences.', filter: c => c.rating >= 4.0, heroClass: 'hero-top-rated' },
  'hidden-gems': { emoji: 'üíé', name: 'Hidden Gems', desc: 'Off the beaten path and far from the tourist crowds. These lesser-known sites reward the curious traveller with peaceful ruins, untold stories, and the thrill of discovery.', filter: c => (c.tags||[]).includes('hidden-gem'), heroClass: 'hero-hidden-gems' },
  'haunted': { emoji: 'üëª', name: 'Haunted & Legendary', desc: 'Where history meets mystery. From ghostly apparitions to ancient curses, these sites carry centuries of dark tales and supernatural legends.', filter: c => (c.tags||[]).includes('haunted'), heroClass: 'hero-haunted' },
  'filming-locations': { emoji: 'üé¨', name: 'Filming Locations', desc: 'As seen on screen. These castles and ruins have starred in beloved films and TV series ‚Äî from Game of Thrones to Harry Potter and beyond.', filter: c => (c.tags||[]).includes('filming-location'), heroClass: 'hero-filming-locations' },
  'free': { emoji: 'üÜì', name: 'Free to Visit', desc: 'Explore without the entry fee. Hundreds of incredible heritage sites across Britain and Ireland that are completely free to access and explore.', filter: c => (c.tags||[]).includes('free') || c.access === 'free', heroClass: 'hero-free' },
  'well-preserved': { emoji: 'üè∞', name: 'Best Preserved', desc: 'Standing strong through the centuries. These remarkably intact sites give you the fullest picture of what medieval life was really like.', filter: c => (c.tags||[]).includes('well-preserved'), heroClass: 'hero-well-preserved' },
  'romantic-ruins': { emoji: 'üåø', name: 'Romantic Ruins', desc: 'Beautifully broken, hauntingly lovely. Ivy-covered walls, crumbling arches, and the quiet poetry of time passing ‚Äî these ruins are endlessly photogenic.', filter: c => (c.tags||[]).includes('romantic-ruin'), heroClass: 'hero-romantic-ruins' },
  'photogenic': { emoji: 'üì∏', name: 'Most Photogenic', desc: 'Bring your best lens. These sites are guaranteed to fill your camera roll with stunning shots ‚Äî dramatic landscapes, perfect symmetry, and golden-hour magic.', filter: c => (c.tags||[]).includes('photogenic'), heroClass: 'hero-photogenic' },
  'kid-friendly': { emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', name: 'Kid-Friendly', desc: 'Adventures the whole family will love. These sites offer engaging experiences for younger visitors ‚Äî interactive exhibits, open spaces to explore, and stories that fire up the imagination.', filter: c => (c.tags||[]).includes('kid-friendly'), heroClass: 'hero-kid-friendly' }
};

function slug(n){ return n.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'') }

const params = new URLSearchParams(window.location.search);
const collId = params.get('id');
const app = document.getElementById('app');

if (!collId) {
  // Show all collections overview
  document.title = 'Collections ‚Äî castlecore';
  let html = '<div class="collection-hero" style="background:linear-gradient(135deg,var(--shadow),var(--hearth))"><h1>All Collections</h1><p class="hero-desc">Curated journeys through Britain and Ireland\'s heritage</p></div>';
  html += '<div class="all-collections"><div class="all-grid">';
  const bgColors = ['#8b6914','#2d5a3d','#5a1a2a','#2c3e5a','#3d7a3e','#6b5d4a','#5e3a6e','#8e4a2a','#2d5a3d'];
  let i = 0;
  for (const [id, col] of Object.entries(COLLECTIONS)) {
    const count = typeof CASTLES !== 'undefined' ? CASTLES.filter(col.filter).length : '?';
    html += `<a class="all-card" href="collection.html?id=${id}" style="background:${bgColors[i%bgColors.length]}"><div class="all-card-overlay"><h3>${col.emoji} ${col.name}</h3><p>${count} sites</p></div></a>`;
    i++;
  }
  html += '</div></div>';
  app.innerHTML = html;
  return;
}

const col = COLLECTIONS[collId];
if (!col) { app.innerHTML = '<div style="text-align:center;padding:120px 24px 64px"><h1>Collection not found</h1><p><a href="collection.html">View all collections ‚Üí</a></p></div>'; return; }

const allSites = (typeof CASTLES !== 'undefined' ? CASTLES : []).filter(col.filter);
document.title = col.emoji + ' ' + col.name + ' ‚Äî castlecore';

// Count countries
const countries = ['England','Scotland','Wales','Ireland','Northern Ireland'];
const countryCounts = {};
countries.forEach(c => { countryCounts[c] = allSites.filter(s => s.country === c).length; });

// Build hero
let html = `<div class="collection-hero ${col.heroClass}"><h1>${col.emoji} ${col.name}</h1><p class="hero-desc">${col.desc}</p><p class="hero-count">${allSites.length} sites</p></div>`;

// Build layout
html += '<div class="main-content">';

// Sidebar
html += '<aside class="filter-sidebar">';
html += '<button class="filter-toggle" id="filterToggle">Filter & Search</button>';
html += '<div class="filter-body" id="filterBody">';
html += '<div class="filter-section"><h4>Search</h4><input type="text" class="filter-search" id="nameSearch" placeholder="Search by name..."></div>';
html += '<div class="filter-section"><h4>Country</h4>';
countries.forEach(c => {
  if (countryCounts[c] > 0) {
    html += `<label class="cb-label"><input type="checkbox" value="${c}" class="country-cb" checked><span class="cb-box"></span>${c}<span class="cb-count">${countryCounts[c]}</span></label>`;
  }
});
html += '</div></div></aside>';

// Results
html += '<div class="results-area"><p class="results-count" id="resultsCount"></p><div class="results-grid" id="resultsGrid"></div></div>';
html += '</div>';

app.innerHTML = html;

// Render
function render() {
  const search = document.getElementById('nameSearch').value.toLowerCase().trim();
  const checked = Array.from(document.querySelectorAll('.country-cb:checked')).map(c => c.value);
  const filtered = allSites.filter(s => {
    if (search && !s.name.toLowerCase().includes(search)) return false;
    if (!checked.includes(s.country)) return false;
    return true;
  });
  document.getElementById('resultsCount').textContent = `Showing ${filtered.length} of ${allSites.length} sites`;
  const grid = document.getElementById('resultsGrid');
  grid.innerHTML = filtered.map(s => {
    const imgHtml = s.image
      ? `<img src="${s.image}" alt="${s.name}" loading="lazy">`
      : '';
    const rating = s.rating ? `<span class="card-rating">‚òÖ ${s.rating}</span>` : '';
    const loc = [s.county, s.country].filter(Boolean).join(', ');
    return `<a class="result-card" href="site/${slug(s.name)}.html"><div class="card-img">${imgHtml}</div><div class="card-body"><h3>${s.name}</h3><p class="card-loc">${loc}</p><div class="card-meta"><span class="type-pill">${s.type||''}</span>${rating}</div></div></a>`;
  }).join('');
}

render();
document.getElementById('nameSearch').addEventListener('input', render);
document.querySelectorAll('.country-cb').forEach(cb => cb.addEventListener('change', render));

// Mobile toggle
const toggle = document.getElementById('filterToggle');
const body = document.getElementById('filterBody');
toggle.addEventListener('click', () => { toggle.classList.toggle('open'); body.classList.toggle('open'); });
// Desktop: show by default
if (window.innerWidth > 768) body.classList.add('open');

})();
</script>
</body>
</html>
